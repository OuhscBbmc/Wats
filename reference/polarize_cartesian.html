<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Three operations are performed.
First, within each stage, the first row is repeated at the end, to close the loop.
Second, multiple points are interpolated (still in a Cartesian coordinates)
so that the polar graph doesn't have sharp edges.
These sharp edges would be artifacts of the conversion, and not reflect the observed data.
Third, the Cartesian points are converted to polar coordinates."><title>Manipulate Cartesian data to use in the WATS polar plot — polarize_cartesian • Wats</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manipulate Cartesian data to use in the WATS polar plot — polarize_cartesian"><meta property="og:description" content="Three operations are performed.
First, within each stage, the first row is repeated at the end, to close the loop.
Second, multiple points are interpolated (still in a Cartesian coordinates)
so that the polar graph doesn't have sharp edges.
These sharp edges would be artifacts of the conversion, and not reflect the observed data.
Third, the Cartesian points are converted to polar coordinates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Wats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mbr-figures.html">Figures for the MBR Manuscript</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/OuhscBbmc/Wats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Manipulate Cartesian data to use in the WATS polar plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/OuhscBbmc/Wats/blob/HEAD/R/polarize-cartesian.R" class="external-link"><code>R/polarize-cartesian.R</code></a></small>
      <div class="d-none name"><code>polarize_cartesian.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Three operations are performed.
First, within each stage, the first row is repeated at the end, to close the loop.
Second, multiple points are interpolated (still in a Cartesian coordinates)
so that the polar graph doesn't have sharp edges.
These sharp edges would be artifacts of the conversion, and not reflect the observed data.
Third, the Cartesian points are converted to polar coordinates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">polarize_cartesian</span><span class="op">(</span></span>
<span>  <span class="va">ds_linear</span>,</span>
<span>  <span class="va">ds_stage_cycle</span>,</span>
<span>  <span class="va">y_name</span>,</span>
<span>  <span class="va">stage_id_name</span>,</span>
<span>  cycle_tally_name <span class="op">=</span> <span class="st">"cycle_tally"</span>,</span>
<span>  proportion_through_cycle_name <span class="op">=</span> <span class="st">"proportion_through_cycle"</span>,</span>
<span>  periodic_lower_name <span class="op">=</span> <span class="st">"position_lower"</span>,</span>
<span>  periodic_center_name <span class="op">=</span> <span class="st">"position_center"</span>,</span>
<span>  periodic_upper_name <span class="op">=</span> <span class="st">"position_upper"</span>,</span>
<span>  plotted_point_count_per_cycle <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  graph_floor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">ds_linear</span><span class="op">[[</span><span class="va">y_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ds_linear</dt>
<dd><p>The <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> to containing the simple linear data.
There should be one record per observation.</p></dd>


<dt>ds_stage_cycle</dt>
<dd><p>The <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> to containing the reoccurring/periodic bands.
There should be one record per observation per stage.
If there are three stages, this <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a> should have three times as many rows as <code>ds_linear</code>.</p></dd>


<dt>y_name</dt>
<dd><p>The variable name containing the dependent/criterion variable.</p></dd>


<dt>stage_id_name</dt>
<dd><p>The variable name indicating which stage the record belongs to.
For example, before the first interruption, the <code>stage_id</code> is "1", and is "2" afterwards.</p></dd>


<dt>cycle_tally_name</dt>
<dd><p>The variable name indicating how many <em>complete</em> cycles have occurred at that observation.</p></dd>


<dt>proportion_through_cycle_name</dt>
<dd><p>The variable name showing how far
through a cycle the observation (or summarized observations) occurred.</p></dd>


<dt>periodic_lower_name</dt>
<dd><p>The variable name showing the lower bound of a stage's periodic estimate.</p></dd>


<dt>periodic_center_name</dt>
<dd><p>The variable name showing the center estimate of a stage's periodic estimate.</p></dd>


<dt>periodic_upper_name</dt>
<dd><p>The variable name showing the upper bound of a stage's periodic estimate.</p></dd>


<dt>plotted_point_count_per_cycle</dt>
<dd><p>The number of points that are plotted per cycle.
If the polar graph has 'sharp corners', then increase this value.</p></dd>


<dt>graph_floor</dt>
<dd><p>The value of the criterion/dependent variable at the center of the polar plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ouhscbbmc.github.io/Wats/">Wats</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ds_linear</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">Wats</span><span class="fu">::</span><span class="va"><a href="county_month_birth_rate.html">county_month_birth_rate_2005_version</a></span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">county_name</span> <span class="op">==</span> <span class="st">"oklahoma"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augment_cycle_data.html">augment_year_data_with_month_resolution</a></span><span class="op">(</span>date_name <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h_spread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">scores</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="annotate_data.html">annotate_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  ds_linear        <span class="op">=</span> <span class="va">ds_linear</span>,</span></span>
<span class="r-in"><span>  dv_name          <span class="op">=</span> <span class="st">"birth_rate"</span>,</span></span>
<span class="r-in"><span>  center_function  <span class="op">=</span> <span class="va">median</span>,</span></span>
<span class="r-in"><span>  spread_function  <span class="op">=</span> <span class="va">h_spread</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">ds_linear</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">polarized</span> <span class="op">&lt;-</span> <span class="fu">polarize_cartesian</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ds_linear      <span class="op">=</span> <span class="va">portfolio</span><span class="op">$</span><span class="va">ds_linear</span>,</span></span>
<span class="r-in"><span>  ds_stage_cycle <span class="op">=</span> <span class="va">portfolio</span><span class="op">$</span><span class="va">ds_stage_cycle</span>,</span></span>
<span class="r-in"><span>  y_name         <span class="op">=</span> <span class="st">"birth_rate"</span>,</span></span>
<span class="r-in"><span>  stage_id_name  <span class="op">=</span> <span class="st">"stage_id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">polarized</span><span class="op">$</span><span class="va">ds_stage_cycle_polar</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage_id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polar_lower_x</span> , y <span class="op">=</span> <span class="va">polar_lower_y</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polar_center_x</span>, y <span class="op">=</span> <span class="va">polar_center_y</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polar_upper_x</span> , y <span class="op">=</span> <span class="va">polar_upper_y</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed_x</span>    , y <span class="op">=</span> <span class="va">observed_y</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">polarized</span><span class="op">$</span><span class="va">ds_observed_polar</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="polarize_cartesian-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Beasley, Joe Rodgers, Oklahoma Shared Clinical and Translational Resource (OSCTR).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

